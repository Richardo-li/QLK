<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <!-- 理想视窗 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1,minimum-scale=1,user-scalable=no">
  <title>千旅客网-结伴</title>
  <link rel="shortcut icon" href="jd.ico" />
  <!-- 添加ico -->
  <link rel="stylesheet" href="mobile/lib/mui/css/mui.min.css" />
  <!-- <link rel="stylesheet" href="lib/fontAwesome/css/font-awesome.min.css" /> -->
  <!-- 字体图标用阿里巴巴的 或者 Mui icon图标 -->
  <link rel="stylesheet" href="mobile/css/common.css" />
  <!-- 日期选择器 -->
  <link rel="stylesheet" href="mobile/lib/mui/css/mui.picker.min.css">
  <!-- 公共样式 顶部侧滑的是公共的-->
  <link rel="stylesheet" href="mobile/lib/lock/lock.css">
  <style>
    .addBtnBox {
      padding: 0.2rem;
      box-sizing: border-box;
      margin-bottom: -5px;
    }

    #add {
      margin-top: 100px;
      padding: 8px 0;
      width: 100%;
      background: #04b9f2;
      color: white;
    }

    #picker {
      height: 40px;
      font-size: 17px;
      display: block;
      width: 100%;
      margin-bottom: 10px;
      text-align: left;
      padding: 8px 12px;
      color: #828282;
    }

    #slide_box {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 89%;
      height: 42px;
      text-align: center;
      line-height: 42px;
      font-size: 14px;
      color: #717171;
      background-color: #e8e8e8;
      border: none;
      margin-bottom: 20px;
    }

    #slide_xbox {
      width: 50px;
      height: 42px;
      text-align: center;
      line-height: 42px;
      font-size: 16px;
      color: #fff;
      position: absolute;
      background: #35b34a;
    }

    #btn {
      cursor: pointer;
      width: 50px;
      height: 42px;
      background-color: #fff;
      float: right;
      -webkit-box-shadow: 0px 0px 15px 0px #ddd;
      -moz-box-shadow: 0px 0px 15px 0px #ddd;
      box-shadow: 0px 0px 15px 0px #ddd;
      color: #8a8c97;

    }

    #btn>.iconfont {
      font-size: 20px;
    }
  </style>


</head>

<body>

  <!-- 侧滑导航根容器 -->
  <div class="mui-off-canvas-wrap mui-draggable mui-slide-in">
    <!-- 菜单容器 -->
    <aside class="mui-off-canvas-right">
      <div id="offCanvasSideScroll" class="mui-scroll-wrapper">
        <div class="mui-scroll">
          <!-- 菜单具体展示内容 -->

          <p style="color:white;font-size:.38rem;margin:.2rem 0 .2rem .2rem;">宗旨</p>
          <div style="color:#bbb;font-size:.23rem;padding:0 .2rem .2rem .2rem;text-align:left;">
            千旅客网致力建设成为背包客驴友穷游时提供最全面最方便的旅行信息和服务。
          </div>
          <ul class="mui-table-view mui-table-view-chevron mui-table-view-inverted menu">
            <li class="mui-table-view-cell">
              <a href="/#" class="mui-navigate-right">
                首页
              </a>
            </li>
            <li class="mui-table-view-cell">
              <a href="/register" class="mui-navigate-right">
                注册
              </a>
            </li>
            <li class="mui-table-view-cell">
              <a href="/login" class="mui-navigate-right">
                登录
              </a>
            </li>
            <li class="mui-table-view-cell">
              <a href="/personalCenter" class="mui-navigate-right">
                个人中心
              </a>
            </li>
            <li class="mui-table-view-cell">
              <a href="javascript:;" class="mui-navigate-right">
                我的文章
              </a>
            </li>

          </ul>

          <button id="offCanvasHide" type="button" class="mui-btn mui-btn-danger mui-btn-block" style="padding: 5px 10px;margin-top:40px;">关闭侧滑菜单</button>

        </div>
      </div>
    </aside>
    <!-- 主页面容器 -->
    <div class="mui-inner-wrap">
      <!-- 主页面标题 -->
      <header class="mui-bar mui-bar-nav">
        <span id="left-menu" class="mui-icon mui-action-menu mui-icon-bars mui-pull-right"></span>

        <a href="javascript:history.go(-1)" class="mui-icon mui-icon-back" style="color:black"></a>
        <h1 class="mui-title">注册</h1>

      </header>
      <div id="offCanvasContentScroll" class="mui-content mui-scroll-wrapper">
        <div class="mui-scroll" style="padding:0.3rem;">


          <div style="width:100%;height:2rem;text-align:center;line-height:2rem;color:#04b9f2;font-size:0.7rem;">用户注册</div>


          <input type="text" id='LoginName' class="mui-input-clear" placeholder="请输入账号">
          <input type="password" id='LoginPwd' class="mui-input-clear" placeholder="请输入密码">
          <input type="password" id='LoginPwd1' class="mui-input-clear" placeholder="请确认密码">

          <!-- 滑动解锁 -->
          <div id="slide_box">
            <div id="slide_xbox">
              <div id="btn">
                <i class="iconfont icon-double-right"></i>
                <img src="" alt="">
              </div>
            </div>
            请按住滑块，拖动到最右边
          </div>


          <div class="addBtnBox">
            <button type="button" id='add' class="mui-btn mui-btn-block">注册</button>
          </div>




        </div>
      </div>
    </div>
  </div>


</body>

</html>
<script src="mobile/lib/zepto/zepto.min.js"></script>
<!-- 移动端jquery -->
<script src="mobile/lib/mui/js/mui.min.js"></script>
<!-- mui -->
<script src="mobile/lib/artTemplate/template-native.js"></script>
<!-- 模板引擎，不用拼接字符串 -->
<script src="mobile/js/common.js"></script>
<!-- 公共js工具 包括 全局ajax工具函数 -->
<script src="mobile/lib/mui/js/mui.picker.min.js"></script>
<script src="mobile/lib/lock/jquery.min.js"></script>
<!-- 日期选择器 -->
<script>

  $(function () {
    mui.init();
    var locked = false;
    slide();
    window.onresize = function () {
      if (locked == true) {
        var boxWidth = $('#slide_box').width();
        $('#slide_xbox').width(boxWidth);
      } else {
        slide();
      }
    }
    //滑动解锁移动
    function slide() {
      var slideBox = $('#slide_box')[0];
      var slideXbox = $('#slide_xbox')[0];
      var btn = $('#btn')[0];
      var slideBoxWidth = slideBox.offsetWidth;
      var btnWidth = btn.offsetWidth;
      //pc端
      btn.ondragstart = function () {
        return false;
      };
      btn.onselectstart = function () {
        return false;
      };
      btn.onmousedown = function (e) {
        var disX = e.clientX - btn.offsetLeft;
        document.onmousemove = function (e) {
          var objX = e.clientX - disX + btnWidth;
          if (objX < btnWidth) {
            objX = btnWidth
          }
          if (objX > slideBoxWidth) {
            objX = slideBoxWidth
          }
          $('#slide_xbox').width(objX + 'px');
        };
        document.onmouseup = function (e) {
          var objX = e.clientX - disX + btnWidth;
          if (objX < slideBoxWidth) {
            objX = btnWidth;
          } else {
            objX = slideBoxWidth;
            locked = true;
            $('#slide_xbox').html('验证通过<div id="btn"><i class="iconfont icon-xuanzhong" style="color: #35b34a;"></i></div>');
          }
          $('#slide_xbox').width(objX + 'px');
          document.onmousemove = null;
          document.onmouseup = null;
        };
      };
      //移动端
      var cont = $("#btn");
      var startX = 0, sX = 0, moveX = 0, leftX = 0;
      cont.on({//绑定事件
        touchstart: function (e) {
          startX = e.originalEvent.targetTouches[0].pageX;//获取点击点的X坐标
          sX = $(this).offset().left;//相对于当前窗口X轴的偏移量
          leftX = startX - sX;//鼠标所能移动的最左端是当前鼠标距div左边距的位置
        },
        touchmove: function (e) {
          e.preventDefault();
          moveX = e.originalEvent.targetTouches[0].pageX;//移动过程中X轴的坐标
          var objX = moveX - leftX + btnWidth;
          if (objX < btnWidth) {
            objX = btnWidth
          }
          if (objX > slideBoxWidth) {
            objX = slideBoxWidth
          }
          $('#slide_xbox').width(objX + 'px');
        },
        touchend: function (e) {
          var objX = moveX - leftX + btnWidth;
          if (objX < slideBoxWidth) {
            objX = btnWidth;
          } else {
            objX = slideBoxWidth;
            locked = true;
            $('#slide_xbox').html('验证通过<div id="btn"><i class="iconfont icon-xuanzhong" style="color: #35b34a;"></i></div>');
          }
          $('#slide_xbox').width(objX + 'px');
        }
      });
    }




    // 表单验证
    $('#add').on('tap', function () {


      if ($('#LoginName')[0].value.trim() == '') {
        mui.toast('请输入账号！');
        return;
      }
      if ($('#LoginPwd')[0].value.trim() == '') {
        mui.toast('请输入密码！');
        return;
      }
      if ($('#LoginPwd1')[0].value.trim() == '') {
        mui.toast('请输入确认密码！');
        return;
      }


      if ($('#LoginPwd')[0].value.trim() != $('#LoginPwd1')[0].value.trim()) {
        mui.toast('两次输入密码不一致！');
        return;
      }

      if ($('#LoginPwd').val().length < 6) {
        mui.toast('密码不能小于6位数！');
        return;
      }

      if (locked == false) {
        mui.toast('请滑动验证！');
        return;
      }


      var data = {
        LoginName: $('#LoginName')[0].value.trim(),
        LoginPwd: $('#LoginPwd')[0].value.trim(),
      }


      $.ajax({
        type: 'post',
        url: "/register",
        data: data,
        dataType: "json",
        success: function (result) {
          console.log(result);
          if (result.code == 200) {
            var btnArray = ['否', '是'];
            mui.confirm('是否跳转到登录页？', `${result.msg}`, btnArray, function (e) {
              if (e.index == 1) {
                window.location.href = "/login";
              } else {
                console.log('取消');
                clear();  //清空所有输入的信息
              }
            })
          } else {
            mui.toast(result.msg);
          }
        }
      });


    })


  })



</script>